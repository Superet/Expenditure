(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     93415,       2577]
NotebookOptionsPosition[     89220,       2441]
NotebookOutlinePosition[     89592,       2458]
CellTagsIndexPosition[     89549,       2455]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Two-period model with liquidity constraints", \
"Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.617886027686262*^9, 3.617886037360567*^9}}],

Cell["\<\
Assum that store 2 limits the product size and one can only buy a large size, \
e.g., x2 > y/p2.
\
\>", "Text",
 CellChangeTimes->{{3.6179810109635353`*^9, 3.617981040032404*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.617886054721285*^9, 3.617886058377235*^9}, 
   3.617971406658901*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimal choices", "Subsubsection",
 CellChangeTimes->{{3.617985170480616*^9, 3.617985188572579*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"u", "=", 
  RowBox[{
   RowBox[{"\[Psi]1", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"x1", "+", "1"}], "]"}]}], "+", 
   RowBox[{"\[Psi]2", " ", 
    RowBox[{"Log", "[", 
     RowBox[{"x2", "+", "1"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"bc1", "=", 
  RowBox[{
   RowBox[{"2", " ", "y"}], " ", "-", " ", 
   RowBox[{"p1", " ", "x1"}], " ", "-", " ", 
   RowBox[{"p2", " ", "x2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"bc2", " ", "=", " ", 
  RowBox[{"y", "+", 
   RowBox[{"y", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}]}], "-", 
   RowBox[{"p2", " ", "x2"}], " ", "-", " ", 
   RowBox[{
    FractionBox["p1", 
     RowBox[{"1", "+", "b"}]], "x1"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"x2Thresh", "=", " ", 
  RowBox[{
   RowBox[{"y", "/", "p2"}], "+", 
   RowBox[{"y", "/", 
    RowBox[{"(", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], "p2"}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.617886070111992*^9, 3.617886080359516*^9}, {
   3.6179631011218433`*^9, 3.617963111639668*^9}, {3.61796362882854*^9, 
   3.617963663862183*^9}, {3.617963708559924*^9, 3.617963731508613*^9}, {
   3.617964190513418*^9, 3.617964197543048*^9}, {3.618053329857583*^9, 
   3.6180533410621767`*^9}, 3.618064559387629*^9, {3.618135897028986*^9, 
   3.618135909594924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Psi]1", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x1"}], "]"}]}], "+", 
  RowBox[{"\[Psi]2", " ", 
   RowBox[{"Log", "[", 
    RowBox[{"1", "+", "x2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.6178860812947598`*^9, 3.6178861776464233`*^9, 3.617963734471073*^9, {
   3.617964199724498*^9, 3.617964217589362*^9}, {3.617965226531557*^9, 
   3.6179652555063467`*^9}, 3.617981049096162*^9, 3.617985119875491*^9, 
   3.617985191231605*^9, 3.617985482670301*^9, 3.61798587301466*^9, 
   3.618050171696521*^9, 3.6180533423134727`*^9, 3.6180645603408823`*^9, 
   3.61813591385845*^9, 3.618137697350584*^9, 3.618218342913807*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "p1"}], " ", "x1"}], "-", 
  RowBox[{"p2", " ", "x2"}], "+", 
  RowBox[{"2", " ", "y"}]}]], "Output",
 CellChangeTimes->{
  3.6178860812947598`*^9, 3.6178861776464233`*^9, 3.617963734471073*^9, {
   3.617964199724498*^9, 3.617964217589362*^9}, {3.617965226531557*^9, 
   3.6179652555063467`*^9}, 3.617981049096162*^9, 3.617985119875491*^9, 
   3.617985191231605*^9, 3.617985482670301*^9, 3.61798587301466*^9, 
   3.618050171696521*^9, 3.6180533423134727`*^9, 3.6180645603408823`*^9, 
   3.61813591385845*^9, 3.618137697350584*^9, 3.6182183429151382`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"p1", " ", "x1"}], 
    RowBox[{"1", "+", "b"}]]}], "-", 
  RowBox[{"p2", " ", "x2"}], "+", "y", "+", 
  FractionBox["y", 
   RowBox[{"1", "+", "b"}]]}]], "Output",
 CellChangeTimes->{
  3.6178860812947598`*^9, 3.6178861776464233`*^9, 3.617963734471073*^9, {
   3.617964199724498*^9, 3.617964217589362*^9}, {3.617965226531557*^9, 
   3.6179652555063467`*^9}, 3.617981049096162*^9, 3.617985119875491*^9, 
   3.617985191231605*^9, 3.617985482670301*^9, 3.61798587301466*^9, 
   3.618050171696521*^9, 3.6180533423134727`*^9, 3.6180645603408823`*^9, 
   3.61813591385845*^9, 3.618137697350584*^9, 3.6182183429161463`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["y", "p2"], "+", 
  FractionBox["y", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]], "Output",
 CellChangeTimes->{
  3.6178860812947598`*^9, 3.6178861776464233`*^9, 3.617963734471073*^9, {
   3.617964199724498*^9, 3.617964217589362*^9}, {3.617965226531557*^9, 
   3.6179652555063467`*^9}, 3.617981049096162*^9, 3.617985119875491*^9, 
   3.617985191231605*^9, 3.617985482670301*^9, 3.61798587301466*^9, 
   3.618050171696521*^9, 3.6180533423134727`*^9, 3.6180645603408823`*^9, 
   3.61813591385845*^9, 3.618137697350584*^9, 3.618218342917117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MRS", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"u", ",", "x1"}], "]"}], "/", 
   RowBox[{"D", "[", 
    RowBox[{"u", ",", "x2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"RP1", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bc1", ",", "x1"}], "]"}], "/", 
   RowBox[{"D", "[", 
    RowBox[{"bc1", ",", "x2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"RP2", "=", "  ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bc2", ",", "x1"}], "]"}], "/", 
   RowBox[{"D", "[", 
    RowBox[{"bc2", ",", "x2"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6178862024607353`*^9, 3.617886243500647*^9}, {
  3.617886288408853*^9, 3.617886293268622*^9}, {3.61796377910907*^9, 
  3.617963791820496*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "x2"}], ")"}], " ", "\[Psi]1"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "x1"}], ")"}], " ", "\[Psi]2"}]]], "Output",
 CellChangeTimes->{{3.617886215418836*^9, 3.6178862450102158`*^9}, 
   3.617886300515753*^9, 3.617963793549842*^9, {3.617964201660734*^9, 
   3.617964219845059*^9}, 3.6179652575437098`*^9, 3.6179810521242037`*^9, 
   3.617985191350162*^9, 3.617985485647729*^9, 3.617985873171226*^9, 
   3.618050173779934*^9, 3.618135915879603*^9, 3.6181376974683247`*^9, 
   3.618218343062766*^9}],

Cell[BoxData[
 FractionBox["p1", "p2"]], "Output",
 CellChangeTimes->{{3.617886215418836*^9, 3.6178862450102158`*^9}, 
   3.617886300515753*^9, 3.617963793549842*^9, {3.617964201660734*^9, 
   3.617964219845059*^9}, 3.6179652575437098`*^9, 3.6179810521242037`*^9, 
   3.617985191350162*^9, 3.617985485647729*^9, 3.617985873171226*^9, 
   3.618050173779934*^9, 3.618135915879603*^9, 3.6181376974683247`*^9, 
   3.618218343064026*^9}],

Cell[BoxData[
 FractionBox["p1", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]], "Output",
 CellChangeTimes->{{3.617886215418836*^9, 3.6178862450102158`*^9}, 
   3.617886300515753*^9, 3.617963793549842*^9, {3.617964201660734*^9, 
   3.617964219845059*^9}, 3.6179652575437098`*^9, 3.6179810521242037`*^9, 
   3.617985191350162*^9, 3.617985485647729*^9, 3.617985873171226*^9, 
   3.618050173779934*^9, 3.618135915879603*^9, 3.6181376974683247`*^9, 
   3.6182183430649557`*^9}]
}, Open  ]],

Cell[TextData[{
 "The optimal choice bundle:\nIf RP2 < RP1 < MRS, then the optimal choice is \
the corner point ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["x", "1"], "c"], "=", 
     RowBox[{"2", 
      RowBox[{"y", "/", 
       SubscriptBox["p", "1"]}]}]}], ",", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["x", "2"], "c"], "=", "0"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ".\n If MRS < RP2 < RP1, then we have interior solution. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["x", "1"], "L"], ",", 
     SuperscriptBox[
      SubscriptBox["x", "2"], "L"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ").\n If RP2 < MRS<RP1, then we have solution at the limit point.\n "
}], "Text",
 CellChangeTimes->{{3.617886124708427*^9, 3.617886129081843*^9}, {
  3.618052920719921*^9, 3.618053070472761*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Corner", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"xstarCorner", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", " ", 
       RowBox[{"2", 
        RowBox[{"y", "/", "p1"}]}]}], ",", 
      RowBox[{"x2", "\[Rule]", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"w1Corner", " ", "=", " ", 
    RowBox[{
     RowBox[{"xstarCorner", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"p1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"w2Corner", " ", "=", " ", 
    RowBox[{
     RowBox[{"xstarCorner", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"p2", "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"CdCorner", " ", "=", " ", 
    RowBox[{
     RowBox[{"RP1", "<", 
      RowBox[{"(", 
       RowBox[{"MRS", "/.", "xstarCorner"}], ")"}]}], "||", 
     RowBox[{"x2Thresh", ">=", 
      RowBox[{
       RowBox[{"y", "/", "p2"}], "+", 
       RowBox[{"y", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "b"}], ")"}], "p2"}], 
         ")"}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.618053089138403*^9, 3.6180532272436333`*^9}, {
   3.618053432540938*^9, 3.618053449391082*^9}, {3.618064338986268*^9, 
   3.618064386437894*^9}, 3.618065230925879*^9, {3.618065369909996*^9, 
   3.618065376030184*^9}, 3.618065457204782*^9, {3.6181365493465757`*^9, 
   3.61813654940219*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "y"}], "p1"]}], ",", 
   RowBox[{"x2", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6180531528519773`*^9, 3.618053169127232*^9}, {
   3.618053212305382*^9, 3.618053227931615*^9}, 3.618064387256955*^9, 
   3.618064566547769*^9, 3.61806537726457*^9, 3.6180654593988657`*^9, 
   3.618135924712134*^9, 3.618137697543725*^9, 3.618218343113099*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6180531528519773`*^9, 3.618053169127232*^9}, {
   3.618053212305382*^9, 3.618053227931615*^9}, 3.618064387256955*^9, 
   3.618064566547769*^9, 3.61806537726457*^9, 3.6180654593988657`*^9, 
   3.618135924712134*^9, 3.618137697543725*^9, 3.618218343114369*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6180531528519773`*^9, 3.618053169127232*^9}, {
   3.618053212305382*^9, 3.618053227931615*^9}, 3.618064387256955*^9, 
   3.618064566547769*^9, 3.61806537726457*^9, 3.6180654593988657`*^9, 
   3.618135924712134*^9, 3.618137697543725*^9, 3.618218343115264*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["p1", "p2"], "<", 
   FractionBox["\[Psi]1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"2", " ", "y"}], "p1"]}], ")"}], " ", "\[Psi]2"}]]}], "||", 
  RowBox[{
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "\[GreaterEqual]", 
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}]], "Output",
 CellChangeTimes->{{3.6180531528519773`*^9, 3.618053169127232*^9}, {
   3.618053212305382*^9, 3.618053227931615*^9}, 3.618064387256955*^9, 
   3.618064566547769*^9, 3.61806537726457*^9, 3.6180654593988657`*^9, 
   3.618135924712134*^9, 3.618137697543725*^9, 3.6182183431163673`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Interior", " ", "solution"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"xstarLiq", "=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MRS", "\[Equal]", "RP2"}], ",", 
          RowBox[{"bc2", "\[Equal]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"w1Liq", "=", 
    RowBox[{
     RowBox[{"xstarLiq", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"p1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"w2Liq", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xstarLiq", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"y", "/", "p2"}]}], ")"}], "*", "p2", "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CdLiq", " ", "=", " ", 
    RowBox[{
     RowBox[{"xstarLiq", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], ">=", 
     "x2Thresh"}]}]}]}]], "Input",
 CellChangeTimes->{{3.617981421970913*^9, 3.617981455849058*^9}, {
  3.6179855427719183`*^9, 3.617985547191607*^9}, {3.61805324586454*^9, 
  3.6180532932620907`*^9}, {3.618053348422124*^9, 3.6180533758157578`*^9}, {
  3.618053463308941*^9, 3.618053498487774*^9}, {3.6181366113890133`*^9, 
  3.618136664163319*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", "\[Psi]1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "b"}], ")"}], " ", "y", " ", "\[Psi]1"}], "-", 
      RowBox[{"p1", " ", "\[Psi]2"}]}], 
     RowBox[{"p1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}], ",", 
   RowBox[{"x2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "+", "b"}], ")"}]}], " ", "p2", " ", "\[Psi]1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
       "\[Psi]2"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
      RowBox[{"(", 
       RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.617981451090623*^9, 3.6179814563434887`*^9}, 
   3.617985191439786*^9, {3.617985533873074*^9, 3.6179855477717133`*^9}, 
   3.6179858732762127`*^9, 3.618050181758172*^9, {3.618053270369117*^9, 
   3.618053293751987*^9}, {3.618053366769072*^9, 3.6180533769734163`*^9}, 
   3.6180645706034193`*^9, 3.618135947854334*^9, {3.6181366437115383`*^9, 
   3.618136664939638*^9}, 3.6181376975890837`*^9, 3.618218343164276*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", "\[Psi]1"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", "b"}], ")"}], " ", "y", " ", "\[Psi]1"}], "-", 
   RowBox[{"p1", " ", "\[Psi]2"}]}], 
  RowBox[{"2", " ", "y", " ", 
   RowBox[{"(", 
    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.617981451090623*^9, 3.6179814563434887`*^9}, 
   3.617985191439786*^9, {3.617985533873074*^9, 3.6179855477717133`*^9}, 
   3.6179858732762127`*^9, 3.618050181758172*^9, {3.618053270369117*^9, 
   3.618053293751987*^9}, {3.618053366769072*^9, 3.6180533769734163`*^9}, 
   3.6180645706034193`*^9, 3.618135947854334*^9, {3.6181366437115383`*^9, 
   3.618136664939638*^9}, 3.6181376975890837`*^9, 3.61821834316689*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", "\[Psi]1"}], "+", 
    RowBox[{"b", " ", "y", " ", "\[Psi]1"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p1", "+", 
       RowBox[{"2", " ", "y"}]}], ")"}], " ", "\[Psi]2"}]}], 
   RowBox[{"2", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.617981451090623*^9, 3.6179814563434887`*^9}, 
   3.617985191439786*^9, {3.617985533873074*^9, 3.6179855477717133`*^9}, 
   3.6179858732762127`*^9, 3.618050181758172*^9, {3.618053270369117*^9, 
   3.618053293751987*^9}, {3.618053366769072*^9, 3.6180533769734163`*^9}, 
   3.6180645706034193`*^9, 3.618135947854334*^9, {3.6181366437115383`*^9, 
   3.618136664939638*^9}, 3.6181376975890837`*^9, 3.618218343211802*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}]}], " ", "p2", " ", "\[Psi]1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
     "\[Psi]2"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], "\[GreaterEqual]", 
  RowBox[{
   FractionBox["y", "p2"], "+", 
   FractionBox["y", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]], "Output",
 CellChangeTimes->{{3.617981451090623*^9, 3.6179814563434887`*^9}, 
   3.617985191439786*^9, {3.617985533873074*^9, 3.6179855477717133`*^9}, 
   3.6179858732762127`*^9, 3.618050181758172*^9, {3.618053270369117*^9, 
   3.618053293751987*^9}, {3.618053366769072*^9, 3.6180533769734163`*^9}, 
   3.6180645706034193`*^9, 3.618135947854334*^9, {3.6181366437115383`*^9, 
   3.618136664939638*^9}, 3.6181376975890837`*^9, 3.618218343213011*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Mid", " ", "piont", " ", "solution", " ", "at", " ", "the", " ", 
    "threshold"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"xstarMid", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y", "-", 
          RowBox[{"p2", 
           RowBox[{"(", 
            RowBox[{"1", "+", "b"}], ")"}], 
           RowBox[{"(", " ", 
            RowBox[{"x2Thresh", "-", 
             RowBox[{"y", "/", "p2"}]}], ")"}]}]}], ")"}], "/", "p1"}]}], " ",
       ",", 
      RowBox[{"x2", "\[Rule]", " ", "x2Thresh"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"w1Mid", " ", "=", " ", 
    RowBox[{
     RowBox[{"xstarMid", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
     RowBox[{"p1", "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"w2Mid", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xstarMid", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"y", "/", "p2"}]}], ")"}], "*", "p2", "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "y"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"CdMid", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"MRS", "/.", "xstarMid"}], ")"}], "<", "RP1"}], " ", "&&", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"MRS", "/.", "xstarMid"}], ")"}], ">", "RP2"}], " ", "&&", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"bc2", "/.", "xstarMid"}], ")"}], "\[GreaterEqual]", "0"}], 
     " ", "&&", 
     RowBox[{"x2Thresh", "<", 
      RowBox[{
       RowBox[{"y", "/", "p2"}], "+", 
       RowBox[{"y", "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "b"}], ")"}], "p2"}], 
         ")"}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6178863099209003`*^9, 3.617886338920896*^9}, {
   3.617886400245708*^9, 3.617886411596363*^9}, {3.6179655975849857`*^9, 
   3.617965641132411*^9}, {3.6179658022442293`*^9, 3.6179660164250183`*^9}, {
   3.617981492976378*^9, 3.617981493457787*^9}, {3.618053484727799*^9, 
   3.61805368515888*^9}, {3.618054762208411*^9, 3.618054762331787*^9}, {
   3.6180645001537523`*^9, 3.618064528176462*^9}, {3.618065238824883*^9, 
   3.618065300576188*^9}, {3.618136281818886*^9, 3.6181363143983*^9}, 
   3.6181364682893476`*^9, {3.618136711316782*^9, 3.618136714969028*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x1", "\[Rule]", 
    FractionBox["y", 
     RowBox[{"2", " ", "p1"}]]}], ",", 
   RowBox[{"x2", "\[Rule]", 
    RowBox[{
     FractionBox["y", "p2"], "+", 
     FractionBox["y", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.618053546181357*^9, {3.618053621503326*^9, 3.6180536543461237`*^9}, 
   3.618053685787528*^9, 3.6180547629770927`*^9, {3.618064528827345*^9, 
   3.618064540369326*^9}, 3.6180645746753798`*^9, 3.618065243443424*^9, 
   3.618065302625208*^9, 3.618135952979849*^9, 3.6181363162358103`*^9, 
   3.618136469057517*^9, 3.618136716341807*^9, 3.618137697640779*^9, 
   3.618218343262005*^9}],

Cell[BoxData[
 FractionBox["1", "4"]], "Output",
 CellChangeTimes->{
  3.618053546181357*^9, {3.618053621503326*^9, 3.6180536543461237`*^9}, 
   3.618053685787528*^9, 3.6180547629770927`*^9, {3.618064528827345*^9, 
   3.618064540369326*^9}, 3.6180645746753798`*^9, 3.618065243443424*^9, 
   3.618065302625208*^9, 3.618135952979849*^9, 3.6181363162358103`*^9, 
   3.618136469057517*^9, 3.618136716341807*^9, 3.618137697640779*^9, 
   3.618218343263218*^9}],

Cell[BoxData[
 FractionBox["3", "4"]], "Output",
 CellChangeTimes->{
  3.618053546181357*^9, {3.618053621503326*^9, 3.6180536543461237`*^9}, 
   3.618053685787528*^9, 3.6180547629770927`*^9, {3.618064528827345*^9, 
   3.618064540369326*^9}, 3.6180645746753798`*^9, 3.618065243443424*^9, 
   3.618065302625208*^9, 3.618135952979849*^9, 3.6181363162358103`*^9, 
   3.618136469057517*^9, 3.618136716341807*^9, 3.618137697640779*^9, 
   3.618218343264077*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ", 
     "\[Psi]1"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", 
        RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], "<", 
   FractionBox["p1", "p2"]}], "&&", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ", 
     "\[Psi]1"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", 
        RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], ">", 
   FractionBox["p1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "&&", 
  RowBox[{
   RowBox[{"y", "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}]}]], "-", 
    RowBox[{"p2", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}]}]}], 
   "\[GreaterEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "<", 
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}]], "Output",
 CellChangeTimes->{
  3.618053546181357*^9, {3.618053621503326*^9, 3.6180536543461237`*^9}, 
   3.618053685787528*^9, 3.6180547629770927`*^9, {3.618064528827345*^9, 
   3.618064540369326*^9}, 3.6180645746753798`*^9, 3.618065243443424*^9, 
   3.618065302625208*^9, 3.618135952979849*^9, 3.6181363162358103`*^9, 
   3.618136469057517*^9, 3.618136716341807*^9, 3.618137697640779*^9, 
   3.6182183432652817`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bLineBase", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"bc1", "\[Equal]", "0"}], ",", "x2"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bLineLiq", " ", "=", " ", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"bc2", "\[Equal]", "0"}], ",", "x2"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bLine", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"UnitStep", "[", 
     RowBox[{"x1", "-", 
      RowBox[{"y", "/", "p1"}]}], "]"}], "*", "bLineBase"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"UnitStep", "[", 
       RowBox[{"x1", "-", 
        RowBox[{"y", "/", "p1"}]}], "]"}]}], ")"}], "*", 
    "bLineLiq"}]}]}]}], "Input",
 CellChangeTimes->{{3.6179814997566347`*^9, 3.617981507237184*^9}, {
  3.617981591682995*^9, 3.617981738338024*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "p1"}], " ", "x1"}], "+", 
   RowBox[{"2", " ", "y"}]}], "p2"]], "Output",
 CellChangeTimes->{{3.6179816586158533`*^9, 3.61798168590628*^9}, 
   3.617981738980146*^9, 3.617985191539064*^9, 3.6179858733982697`*^9, 
   3.618050537030085*^9, 3.618064589815735*^9, 3.618135959473414*^9, 
   3.618137697711226*^9, 3.618218343315029*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "p1"}], " ", "x1"}], "+", 
   RowBox[{"2", " ", "y"}], "+", 
   RowBox[{"b", " ", "y"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]], "Output",
 CellChangeTimes->{{3.6179816586158533`*^9, 3.61798168590628*^9}, 
   3.617981738980146*^9, 3.617985191539064*^9, 3.6179858733982697`*^9, 
   3.618050537030085*^9, 3.618064589815735*^9, 3.618135959473414*^9, 
   3.618137697711226*^9, 3.618218343316359*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "p1"}], " ", "x1"}], "+", 
      RowBox[{"2", " ", "y"}], "+", 
      RowBox[{"b", " ", "y"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"UnitStep", "[", 
       RowBox[{"x1", "-", 
        FractionBox["y", "p1"]}], "]"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "p1"}], " ", "x1"}], "+", 
      RowBox[{"2", " ", "y"}]}], ")"}], " ", 
    RowBox[{"UnitStep", "[", 
     RowBox[{"x1", "-", 
      FractionBox["y", "p1"]}], "]"}]}], "p2"]}]], "Output",
 CellChangeTimes->{{3.6179816586158533`*^9, 3.61798168590628*^9}, 
   3.617981738980146*^9, 3.617985191539064*^9, 3.6179858733982697`*^9, 
   3.618050537030085*^9, 3.618064589815735*^9, 3.618135959473414*^9, 
   3.618137697711226*^9, 3.618218343317525*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"IdCurveCorner", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "/.", "xstarCorner"}], ")"}], "\[Equal]", "u"}], ",", 
      "x2"}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"IdCurveLiq", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "/.", "xstarLiq"}], ")"}], "\[Equal]", "u"}], ",", 
      "x2"}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"IdCurveMid", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "/.", "xstarMid"}], ")"}], "\[Equal]", "u"}], ",", 
      "x2"}], "]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6179818630761223`*^9, 3.617981892723526*^9}, {
  3.618053736111245*^9, 3.618053800979149*^9}, {3.6180538962008038`*^9, 
  3.6180538981997833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x1"}], ")"}], 
    RowBox[{"-", 
     FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"2", " ", "y"}], "p1"]}], ")"}], 
    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}]}]], "Output",
 CellChangeTimes->{{3.617981879257326*^9, 3.617981893778438*^9}, 
   3.617985191662339*^9, 3.617985873526113*^9, 3.618050538847209*^9, 
   3.618053808608335*^9, 3.618054055237355*^9, 3.618064591602676*^9, 
   3.618135962264824*^9, 3.618136342659814*^9, 3.618136476706024*^9, 
   3.6181376977559557`*^9, 3.618218343361471*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x1"}], ")"}], 
    RowBox[{"-", 
     FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", "\[Psi]2",
       " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
          "\[Psi]1"}], 
         RowBox[{"p1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ")"}], 
       RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "x1"}], ")"}], 
          RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], " ", "\[Psi]1"}], "+", 
        RowBox[{"\[Psi]2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "x1"}], ")"}], 
            RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p1", "+", "p2", "+", 
                 RowBox[{"b", " ", "p2"}], "+", 
                 RowBox[{"2", " ", "y"}], "+", 
                 RowBox[{"b", " ", "y"}]}], ")"}], " ", "\[Psi]1"}], 
              RowBox[{"p1", " ", 
               RowBox[{"(", 
                RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ")"}], 
            RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], ")"}]}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
   RowBox[{"(", 
    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.617981879257326*^9, 3.617981893778438*^9}, 
   3.617985191662339*^9, 3.617985873526113*^9, 3.618050538847209*^9, 
   3.618053808608335*^9, 3.618054055237355*^9, 3.618064591602676*^9, 
   3.618135962264824*^9, 3.618136342659814*^9, 3.618136476706024*^9, 
   3.6181376977559557`*^9, 3.618218343517894*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x1"}], ")"}], 
    RowBox[{"-", 
     FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", "b"}]}], ")"}], " ", "y", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["y", 
          RowBox[{"2", " ", "p1"}]]}], ")"}], 
       RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "x1"}], ")"}], 
         RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           FractionBox["y", 
            RowBox[{"2", " ", "p1"}]]}], ")"}], 
         RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], ")"}]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]], "Output",
 CellChangeTimes->{{3.617981879257326*^9, 3.617981893778438*^9}, 
   3.617985191662339*^9, 3.617985873526113*^9, 3.618050538847209*^9, 
   3.618053808608335*^9, 3.618054055237355*^9, 3.618064591602676*^9, 
   3.618135962264824*^9, 3.618136342659814*^9, 3.618136476706024*^9, 
   3.6181376977559557`*^9, 3.61821834359873*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot illustration", "Subsubsection",
 CellChangeTimes->{{3.6179820215803537`*^9, 3.617982024595413*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "p1"}], " ", "x1"}], "+", 
                    RowBox[{"2", " ", "y"}], "+", 
                    RowBox[{"b", " ", "y"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"x1", "-", 
                    FractionBox["y", "p1"]}], "]"}]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "p1"}], " ", "x1"}], "+", 
                    RowBox[{"2", " ", "y"}]}], ")"}], " ", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{"x1", "-", 
                    FractionBox["y", "p1"]}], "]"}]}], "p2"]}], ",", 
                "\"\<Budget line\>\""}], "]"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                   RowBox[{"-", 
                    FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{"2", " ", "b"}]}], ")"}], " ", "y", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    FractionBox["y", 
                    RowBox[{"2", " ", "p1"}]]}], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    FractionBox["y", 
                    RowBox[{"2", " ", "p1"}]]}], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], ")"}]}]}], 
                   ")"}]}], 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]], ",", 
                "\"\<Indifference curve at midpoint solution\>\""}], "]"}], 
              ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                   RowBox[{"-", 
                    FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
                    "\[Psi]2", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
                    "\[Psi]1"}], 
                    RowBox[{"p1", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], " ", "\[Psi]1"}], 
                    "+", 
                    RowBox[{"\[Psi]2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]], "-", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p1", "+", "p2", "+", 
                    RowBox[{"b", " ", "p2"}], "+", 
                    RowBox[{"2", " ", "y"}], "+", 
                    RowBox[{"b", " ", "y"}]}], ")"}], " ", "\[Psi]1"}], 
                    RowBox[{"p1", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ")"}], 
                    RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ",", 
                "\"\<Indifference curve at interior solution\>\""}], "]"}], 
              ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x1"}], ")"}], 
                   RowBox[{"-", 
                    FractionBox["\[Psi]1", "\[Psi]2"]}]], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    FractionBox[
                    RowBox[{"2", " ", "y"}], "p1"]}], ")"}], 
                   RowBox[{"\[Psi]1", "/", "\[Psi]2"}]]}]}], ",", 
                "\"\<Indifference curve at corner solution\>\""}], "]"}]}], 
             "}"}], ",", " ", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x1", ",", " ", "0", ",", " ", "5"}], "}"}], ",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Dashed", ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    FractionBox["y", "p2"], "+", 
                    FractionBox["y", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    RowBox[{" ", "y"}], 
                    RowBox[{"2", " ", "p1"}]], ",", 
                    RowBox[{
                    FractionBox["y", "p2"], "+", 
                    FractionBox["y", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}], "}"}]}],
                    "}"}], "]"}]}], "}"}], ",", 
               "\"\<The minimum quantity required\>\""}], "]"}]}], ",", " ", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Blue", ",", "Gray", ",", "Red"}], 
              "}"}]}], ",", " ", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "5"}], "}"}]}], ",", " ", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(1\)]\)\>\"", ",", " ", 
                 "16"}], "]"}], ",", " ", 
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(x\), \(2\)]\)\>\"", ",", " ", 
                 "16"}], "]"}]}], "}"}]}], ",", " ", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"Style", "[", 
              RowBox[{
              "\"\<Figure: Consumer's Optimal Choice\>\"", ",", " ", "16"}], 
              "]"}]}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox[
                    RowBox[{" ", "y"}], 
                    RowBox[{"2", " ", "p1"}]], ",", 
                   RowBox[{
                    FractionBox["y", "p2"], "+", 
                    FractionBox["y", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}], "}"}], 
                 "}"}], ",", " ", 
                "\"\<Mid-point solution at x2 threshold\>\""}], "]"}], ",", 
              " ", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
                    "\[Psi]1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", "b"}], ")"}], " ", "y", " ", 
                    "\[Psi]1"}], "-", 
                    RowBox[{"p1", " ", "\[Psi]2"}]}], 
                    RowBox[{"p1", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], ",", 
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}]}], " ", "p2", " ", 
                    "\[Psi]1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
                    "\[Psi]2"}]}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}], "}"}], 
                 "}"}], ",", " ", "\"\<Interior solution)\>\""}], "]"}], ",", 
              
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"2", " ", "y"}], "p1"], ",", "0"}], "}"}], "}"}], 
                ",", " ", "\"\<Corner solution)\>\""}], "]"}]}], "}"}], ",", 
            " ", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"PointSize", "[", "Large", "]"}], "}"}]}], ",", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<M\>\"", ",", "\"\<I\>\"", ",", "\"\<C\>\""}], 
              "}"}]}]}], "]"}]}], "]"}], ",", " ", "SpanFromLeft"}], "}"}], 
      "}"}], ",", " ", 
     RowBox[{"Dividers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", " ", "All"}], "}"}]}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"550", ",", "350"}], "}"}]}]}], "]"}], ",", " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", ",", " ", "2", ",", " ", "\"\<consumer's budget\>\""}], 
      "}"}], ",", " ", "0", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p1", ",", " ", "2", ",", " ", 
       "\"\<price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)\>\""}], 
      "}"}], ",", " ", "0.5", ",", " ", "3", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p2", ",", " ", "1", ",", " ", 
       "\"\<price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)\>\""}], 
      "}"}], ",", " ", "0.5", ",", " ", "3", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", " ", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]1", ",", " ", "1", ",", " ", "\"\<Quality of store 1\>\""}], 
      "}"}], ",", " ", "0.1", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]2", ",", " ", "1", ",", " ", "\"\<Quality of store 2\>\""}], 
      "}"}], ",", " ", "0.1", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "1", ",", " ", "\"\<Borrowing rate\>\""}], "}"}],
      ",", " ", "0.1", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6179820331771803`*^9, 3.6179820745761423`*^9}, {
   3.617983597339932*^9, 3.617983675679516*^9}, {3.6179837088896313`*^9, 
   3.617983804391781*^9}, {3.617983889545833*^9, 3.617984032611662*^9}, {
   3.617984070004109*^9, 3.617984070067521*^9}, {3.617984113417453*^9, 
   3.617984197257092*^9}, {3.617984232044314*^9, 3.61798423461814*^9}, 
   3.617984463974525*^9, {3.617984777746183*^9, 3.61798480143808*^9}, {
   3.617984864047512*^9, 3.617984864384859*^9}, {3.6179859176971827`*^9, 
   3.617985978248974*^9}, {3.617986013257609*^9, 3.61798601664258*^9}, 
   3.617986182187491*^9, {3.618053930516836*^9, 3.618053976130924*^9}, {
   3.6180540106397667`*^9, 3.618054144039083*^9}, {3.618054191634647*^9, 
   3.618054231197344*^9}, 3.6181359949650383`*^9, {3.618136029496339*^9, 
   3.618136031981316*^9}, {3.61813635643853*^9, 3.6181363749758*^9}, {
   3.6181364890981894`*^9, 3.61813650460603*^9}, {3.6181369394052343`*^9, 
   3.618137043916993*^9}, {3.618137138237124*^9, 3.618137192743321*^9}, {
   3.6181372424594717`*^9, 3.618137243234659*^9}, {3.618218358708137*^9, 
   3.618218358882236*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`b$$ = 1, $CellContext`p1$$ = 
    2, $CellContext`p2$$ = 1, $CellContext`y$$ = 2, $CellContext`\[Psi]1$$ = 
    1, $CellContext`\[Psi]2$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`y$$], 2, "consumer's budget"}, 0, 10}, {{
       Hold[$CellContext`p1$$], 2, 
       "price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)"}, 0.5, 3}, {{
       Hold[$CellContext`p2$$], 1, 
       "price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)"}, 0.5, 3}, {{
       Hold[$CellContext`\[Psi]1$$], 1, "Quality of store 1"}, 0.1, 10}, {{
       Hold[$CellContext`\[Psi]2$$], 1, "Quality of store 2"}, 0.1, 10}, {{
       Hold[$CellContext`b$$], 1, "Borrowing rate"}, 0.1, 10}}, 
    Typeset`size$$ = {825., {257., 268.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True, $CellContext`y$586$$ = 
    0, $CellContext`p1$591$$ = 0, $CellContext`p2$592$$ = 
    0, $CellContext`\[Psi]1$593$$ = 0, $CellContext`\[Psi]2$594$$ = 
    0, $CellContext`b$595$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`b$$ = 1, $CellContext`p1$$ = 
        2, $CellContext`p2$$ = 1, $CellContext`y$$ = 
        2, $CellContext`\[Psi]1$$ = 1, $CellContext`\[Psi]2$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`y$$, $CellContext`y$586$$, 0], 
        Hold[$CellContext`p1$$, $CellContext`p1$591$$, 0], 
        Hold[$CellContext`p2$$, $CellContext`p2$592$$, 0], 
        Hold[$CellContext`\[Psi]1$$, $CellContext`\[Psi]1$593$$, 0], 
        Hold[$CellContext`\[Psi]2$$, $CellContext`\[Psi]2$594$$, 0], 
        Hold[$CellContext`b$$, $CellContext`b$595$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> GraphicsGrid[{{
          Show[
           Plot[{
             
             Tooltip[((-$CellContext`p1$$) $CellContext`x1 + 
                2 $CellContext`y$$ + $CellContext`b$$ $CellContext`y$$) (1 - 
                UnitStep[$CellContext`x1 - \
$CellContext`y$$/$CellContext`p1$$])/((
                1 + $CellContext`b$$) $CellContext`p2$$) + \
((-$CellContext`p1$$) $CellContext`x1 + 2 $CellContext`y$$) 
               UnitStep[$CellContext`x1 - \
$CellContext`y$$/$CellContext`p1$$]/$CellContext`p2$$, "Budget line"], 
             
             Tooltip[(
                1 + $CellContext`x1)^(-($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$)) ((3 + 2 $CellContext`b$$) $CellContext`y$$ (
                  1 + $CellContext`y$$/(
                   2 $CellContext`p1$$))^($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$) - 2 (
                1 + $CellContext`b$$) $CellContext`p2$$ ((
                  1 + $CellContext`x1)^($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$) - (1 + $CellContext`y$$/(
                  2 $CellContext`p1$$))^($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$)))/(2 (1 + $CellContext`b$$) $CellContext`p2$$), 
              "Indifference curve at midpoint solution"], 
             
             Tooltip[(
                1 + $CellContext`x1)^(-($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$)) (($CellContext`p1$$ + (
                   2 + $CellContext`b$$) $CellContext`y$$) \
$CellContext`\[Psi]2$$ (($CellContext`p1$$ + (
                    1 + $CellContext`b$$) $CellContext`p2$$ + (
                    2 + $CellContext`b$$) $CellContext`y$$) $CellContext`\
\[Psi]1$$/($CellContext`p1$$ ($CellContext`\[Psi]1$$ + \
$CellContext`\[Psi]2$$)))^($CellContext`\[Psi]1$$/$CellContext`\[Psi]2$$) - (
                1 + $CellContext`b$$) $CellContext`p2$$ ((
                   1 + $CellContext`x1)^($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$) $CellContext`\[Psi]1$$ + $CellContext`\[Psi]2$$ ((
                    1 + $CellContext`x1)^($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$) - (($CellContext`p1$$ + $CellContext`p2$$ + $CellContext`b$$ \
$CellContext`p2$$ + 
                    2 $CellContext`y$$ + $CellContext`b$$ $CellContext`y$$) \
$CellContext`\[Psi]1$$/($CellContext`p1$$ ($CellContext`\[Psi]1$$ + \
$CellContext`\[Psi]2$$)))^($CellContext`\[Psi]1$$/$CellContext`\[Psi]2$$))))/(\
(1 + $CellContext`b$$) $CellContext`p2$$ ($CellContext`\[Psi]1$$ + \
$CellContext`\[Psi]2$$)), "Indifference curve at interior solution"], 
             
             Tooltip[-1 + (
                 1 + $CellContext`x1)^(-($CellContext`\[Psi]1$$/$CellContext`\
\[Psi]2$$)) (1 + 
                 2 $CellContext`y$$/$CellContext`p1$$)^($CellContext`\[Psi]1$$\
/$CellContext`\[Psi]2$$), 
              "Indifference curve at corner solution"]}, {$CellContext`x1, 0, 
             5}, Epilog -> Tooltip[{Dashed, 
               
               Line[{{0, $CellContext`y$$/$CellContext`p2$$ + \
$CellContext`y$$/(2 (
                    1 + $CellContext`b$$) $CellContext`p2$$)}, \
{$CellContext`y$$/(
                  2 $CellContext`p1$$), $CellContext`y$$/$CellContext`p2$$ + \
$CellContext`y$$/(2 (1 + $CellContext`b$$) $CellContext`p2$$)}}]}, 
              "The minimum quantity required"], 
            PlotStyle -> {Black, Blue, Gray, Red}, PlotRange -> {0, 5}, 
            AxesLabel -> {
              Style["\!\(\*SubscriptBox[\(x\), \(1\)]\)", 16], 
              Style["\!\(\*SubscriptBox[\(x\), \(2\)]\)", 16]}, PlotLabel -> 
            Style["Figure 1: Consumer's Optimal Choice", 16]], 
           ListPlot[{
             
             Tooltip[{{$CellContext`y$$/(
                2 $CellContext`p1$$), $CellContext`y$$/$CellContext`p2$$ + \
$CellContext`y$$/(2 (1 + $CellContext`b$$) $CellContext`p2$$)}}, 
              "Mid-point solution at x2 threshold"], 
             
             Tooltip[{{((
                   1 + $CellContext`b$$) $CellContext`p2$$ \
$CellContext`\[Psi]1$$ + (
                   2 + $CellContext`b$$) $CellContext`y$$ \
$CellContext`\[Psi]1$$ - $CellContext`p1$$ \
$CellContext`\[Psi]2$$)/($CellContext`p1$$ ($CellContext`\[Psi]1$$ + \
$CellContext`\[Psi]2$$)), ((-(
                    1 + $CellContext`b$$)) $CellContext`p2$$ $CellContext`\
\[Psi]1$$ + ($CellContext`p1$$ + (
                    2 + $CellContext`b$$) $CellContext`y$$) $CellContext`\
\[Psi]2$$)/((
                 1 + $CellContext`b$$) $CellContext`p2$$ \
($CellContext`\[Psi]1$$ + $CellContext`\[Psi]2$$))}}, "Interior solution)"], 
             
             Tooltip[{{2 $CellContext`y$$/$CellContext`p1$$, 0}}, 
              "Corner solution)"]}, PlotStyle -> {
              PointSize[Large]}, PlotMarkers -> {"M", "I", "C"}]], 
          SpanFromLeft}}, Dividers -> {False, All}, Frame -> True, 
        ImageSize -> {550, 350}], 
      "Specifications" :> {{{$CellContext`y$$, 2, "consumer's budget"}, 0, 10,
          Appearance -> 
         "Labeled"}, {{$CellContext`p1$$, 2, 
          "price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)"}, 0.5, 3, 
         Appearance -> 
         "Labeled"}, {{$CellContext`p2$$, 1, 
          "price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)"}, 0.5, 3, 
         Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`\[Psi]1$$, 1, "Quality of store 1"}, 0.1, 
         10, Appearance -> 
         "Labeled"}, {{$CellContext`\[Psi]2$$, 1, "Quality of store 2"}, 0.1, 
         10, Appearance -> 
         "Labeled"}, {{$CellContext`b$$, 1, "Borrowing rate"}, 0.1, 10, 
         Appearance -> "Labeled"}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{889., {436., 443.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.618137026483768*^9, 3.618137053392809*^9}, 
   3.618137150252706*^9, 3.618137193940132*^9, 3.618137243939242*^9, 
   3.618137699791601*^9, 3.6182183467383003`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparative statistics", "Subsubsection",
 CellChangeTimes->{{3.618054430486413*^9, 3.618054435704255*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"CdLiq", "\[IndentingNewLine]", "CdCorner", \
"\[IndentingNewLine]", "CdMid"}], "Input",
 CellChangeTimes->{{3.618054487926668*^9, 3.618054505613427*^9}, {
  3.618054879523354*^9, 3.618054882020369*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}]}], " ", "p2", " ", "\[Psi]1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", 
     "\[Psi]2"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]], "\[GreaterEqual]", 
  RowBox[{
   FractionBox["y", "p2"], "+", 
   FractionBox["y", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]], "Output",
 CellChangeTimes->{3.6180545061718607`*^9, 3.618054883520711*^9, 
  3.618064401712*^9, 3.618064642841695*^9, 3.618065311121401*^9, 
  3.618065384958026*^9, 3.618065465187047*^9, 3.618137288924066*^9, 
  3.6181377064030323`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["p1", "p2"], "<", 
   FractionBox["\[Psi]1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox[
        RowBox[{"2", " ", "y"}], "p1"]}], ")"}], " ", "\[Psi]2"}]]}], "||", 
  RowBox[{
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "\[GreaterEqual]", 
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}]], "Output",
 CellChangeTimes->{3.6180545061718607`*^9, 3.618054883520711*^9, 
  3.618064401712*^9, 3.618064642841695*^9, 3.618065311121401*^9, 
  3.618065384958026*^9, 3.618065465187047*^9, 3.618137288924066*^9, 
  3.618137706405696*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ", 
     "\[Psi]1"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", 
        RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], "<", 
   FractionBox["p1", "p2"]}], "&&", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ", 
     "\[Psi]1"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       FractionBox["y", 
        RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], ">", 
   FractionBox["p1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "&&", 
  RowBox[{
   RowBox[{"y", "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}]}]], "-", 
    RowBox[{"p2", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["y", "p2"], "+", 
       FractionBox["y", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}]}]}], 
   "\[GreaterEqual]", "0"}], "&&", 
  RowBox[{
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "<", 
   RowBox[{
    FractionBox["y", "p2"], "+", 
    FractionBox["y", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}]], "Output",
 CellChangeTimes->{3.6180545061718607`*^9, 3.618054883520711*^9, 
  3.618064401712*^9, 3.618064642841695*^9, 3.618065311121401*^9, 
  3.618065384958026*^9, 3.618065465187047*^9, 3.618137288924066*^9, 
  3.618137706407508*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"w2Corner", "\[IndentingNewLine]", "w2Mid", \
"\[IndentingNewLine]", "w2Liq"}], "Input",
 CellChangeTimes->{{3.6180547252603083`*^9, 3.6180547751425047`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.618054775758225*^9, 3.618064644531508*^9, 
  3.618137292185679*^9, 3.618137708022826*^9}],

Cell[BoxData[
 FractionBox["3", "4"]], "Output",
 CellChangeTimes->{3.618054775758225*^9, 3.618064644531508*^9, 
  3.618137292185679*^9, 3.618137708024065*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", "\[Psi]1"}], "+", 
    RowBox[{"b", " ", "y", " ", "\[Psi]1"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p1", "+", 
       RowBox[{"2", " ", "y"}]}], ")"}], " ", "\[Psi]2"}]}], 
   RowBox[{"2", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.618054775758225*^9, 3.618064644531508*^9, 
  3.618137292185679*^9, 3.618137708025086*^9}]
}, Open  ]],

Cell["\<\
In sum, expenditure share is not responsive to income, borrowing rate, price, \
or store quality under the condition of corner solution or mid-point \
solution. The graph below shows the conditions when the \
\[OpenCurlyDoubleQuote]sticky\[CloseCurlyDoubleQuote] regions. \
\>", "Text",
 CellChangeTimes->{{3.618055502369248*^9, 3.618055547189322*^9}, {
  3.618055859697373*^9, 3.618055884770522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"RegionPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["p1", "p2"], "<", 
            FractionBox["\[Psi]1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 RowBox[{"2", " ", "y"}], "p1"]}], ")"}], " ", "\[Psi]2"}]]}],
            "||", 
           RowBox[{
            RowBox[{
             FractionBox["y", "p2"], "+", 
             FractionBox["y", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], 
            "\[GreaterEqual]", 
            RowBox[{
             FractionBox["y", "p2"], "+", 
             FractionBox["y", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}], ",", 
          "\"\<Corner solution condition\>\""}], "]"}], ",", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["y", "p2"], "+", 
                FractionBox["y", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ",
               "\[Psi]1"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["y", 
                 RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], "<", 
            FractionBox["p1", "p2"]}], "&&", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["y", "p2"], "+", 
                FractionBox["y", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}], " ",
               "\[Psi]1"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox["y", 
                 RowBox[{"2", " ", "p1"}]]}], ")"}], " ", "\[Psi]2"}]], ">", 
            FractionBox["p1", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "&&", 
           RowBox[{
            RowBox[{"y", "+", 
             FractionBox["y", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "b"}], ")"}]}]], "-", 
             RowBox[{"p2", " ", 
              RowBox[{"(", 
               RowBox[{
                FractionBox["y", "p2"], "+", 
                FractionBox["y", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], ")"}]}]}], 
            "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{
             FractionBox["y", "p2"], "+", 
             FractionBox["y", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}], "<", 
            RowBox[{
             FractionBox["y", "p2"], "+", 
             FractionBox["y", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}]]}]}]}], ",", 
          "\"\<Midpoint solution condition\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0.1", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "0.1", ",", "10"}], "}"}], ",", " ", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"y", ",", "b"}], "}"}]}], ",", 
      RowBox[{"RotateLabel", "\[Rule]", "False"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"FontSize", "\[Rule]", "16"}], ")"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<Figure: parameter space for rigid conditions\>\"", ",", " ", 
         "16"}], "]"}]}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p1", ",", " ", "2", ",", " ", 
       "\"\<price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)\>\""}], 
      "}"}], ",", " ", "0.5", ",", " ", "3", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p2", ",", " ", "1", ",", " ", 
       "\"\<price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)\>\""}], 
      "}"}], ",", " ", "0.5", ",", " ", "3", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", " ", 
   "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]1", ",", " ", "1", ",", " ", "\"\<Quality of store 1\>\""}], 
      "}"}], ",", " ", "0.1", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Psi]2", ",", " ", "1", ",", " ", "\"\<Quality of store 2\>\""}], 
      "}"}], ",", " ", "0.1", ",", " ", "10", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.618056210146812*^9, 3.618056264923202*^9}, {
   3.618056343652535*^9, 3.6180563807845592`*^9}, {3.618056432204094*^9, 
   3.61805646031855*^9}, {3.6180565056543417`*^9, 3.6180565946951838`*^9}, {
   3.618056624843628*^9, 3.6180566778183203`*^9}, {3.618056763411969*^9, 
   3.618056767629887*^9}, {3.618056870864992*^9, 3.618056923936946*^9}, {
   3.6180569943196993`*^9, 3.618056997468478*^9}, {3.618057125698872*^9, 
   3.6180571284291487`*^9}, 3.6180644113319473`*^9, {3.6180653182290773`*^9, 
   3.618065351255089*^9}, 3.6180653927680798`*^9, 3.618065468108012*^9, {
   3.6181373590200367`*^9, 3.618137400544256*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p1$$ = 2, $CellContext`p2$$ = 
    1, $CellContext`\[Psi]1$$ = 1, $CellContext`\[Psi]2$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`p1$$], 2, 
       "price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)"}, 0.5, 3}, {{
       Hold[$CellContext`p2$$], 1, 
       "price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)"}, 0.5, 3}, {{
       Hold[$CellContext`\[Psi]1$$], 1, "Quality of store 1"}, 0.1, 10}, {{
       Hold[$CellContext`\[Psi]2$$], 1, "Quality of store 2"}, 0.1, 10}}, 
    Typeset`size$$ = {540., {284., 294.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`p1$9955$$ = 0, $CellContext`p2$9956$$ = 
    0, $CellContext`\[Psi]1$9957$$ = 0, $CellContext`\[Psi]2$9958$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`p1$$ = 2, $CellContext`p2$$ = 
        1, $CellContext`\[Psi]1$$ = 1, $CellContext`\[Psi]2$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`p1$$, $CellContext`p1$9955$$, 0], 
        Hold[$CellContext`p2$$, $CellContext`p2$9956$$, 0], 
        Hold[$CellContext`\[Psi]1$$, $CellContext`\[Psi]1$9957$$, 0], 
        Hold[$CellContext`\[Psi]2$$, $CellContext`\[Psi]2$9958$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Show[
        RegionPlot[{
          Tooltip[
           
           Or[$CellContext`p1$$/$CellContext`p2$$ < $CellContext`\[Psi]1$$/((
              1 + 2 ($CellContext`y/$CellContext`p1$$)) \
$CellContext`\[Psi]2$$), $CellContext`y/$CellContext`p2$$ + $CellContext`y/((
               2 (
                1 + $CellContext`b)) $CellContext`p2$$) >= \
$CellContext`y/$CellContext`p2$$ + $CellContext`y/((
               1 + $CellContext`b) $CellContext`p2$$)], 
           "Corner solution condition"], 
          Tooltip[
           
           And[(1 + $CellContext`y/$CellContext`p2$$ + $CellContext`y/((
                2 (1 + $CellContext`b)) $CellContext`p2$$)) ($CellContext`\
\[Psi]1$$/((1 + $CellContext`y/(
                2 $CellContext`p1$$)) $CellContext`\[Psi]2$$)) < \
$CellContext`p1$$/$CellContext`p2$$, (
              1 + $CellContext`y/$CellContext`p2$$ + $CellContext`y/((
                2 (1 + $CellContext`b)) $CellContext`p2$$)) ($CellContext`\
\[Psi]1$$/((1 + $CellContext`y/(
                2 $CellContext`p1$$)) $CellContext`\[Psi]2$$)) > \
$CellContext`p1$$/((
              1 + $CellContext`b) $CellContext`p2$$), $CellContext`y + \
$CellContext`y/(
              2 (1 + $CellContext`b)) - $CellContext`p2$$ \
($CellContext`y/$CellContext`p2$$ + $CellContext`y/((
                2 (1 + $CellContext`b)) $CellContext`p2$$)) >= 
            0, $CellContext`y/$CellContext`p2$$ + $CellContext`y/((
               2 (1 + $CellContext`b)) $CellContext`p2$$) < \
$CellContext`y/$CellContext`p2$$ + $CellContext`y/((
               1 + $CellContext`b) $CellContext`p2$$)], 
           "Midpoint solution condition"]}, {$CellContext`y, 0.1, 
          5}, {$CellContext`b, 0.1, 10}, 
         FrameLabel -> {$CellContext`y, $CellContext`b}, RotateLabel -> False,
          LabelStyle -> (FontSize -> 16), PlotLabel -> 
         Style["Figure: parameter space for rigid conditions", 16]]], 
      "Specifications" :> {{{$CellContext`p1$$, 2, 
          "price at store 1, \!\(\*SubscriptBox[\(p\), \(1\)]\)"}, 0.5, 3, 
         Appearance -> 
         "Labeled"}, {{$CellContext`p2$$, 1, 
          "price at store 2, \!\(\*SubscriptBox[\(p\), \(2\)]\)"}, 0.5, 3, 
         Appearance -> "Labeled"}, 
        Delimiter, {{$CellContext`\[Psi]1$$, 1, "Quality of store 1"}, 0.1, 
         10, Appearance -> 
         "Labeled"}, {{$CellContext`\[Psi]2$$, 1, "Quality of store 2"}, 0.1, 
         10, Appearance -> "Labeled"}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{604., {421., 429.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6180565452050457`*^9, 3.618056595760007*^9, {3.6180566701690083`*^9, 
   3.618056678497632*^9}, 3.618056772340756*^9, 3.618056878496414*^9, 
   3.6180569245645103`*^9, 3.618056975218523*^9, 3.618057055142325*^9, 
   3.618057129011549*^9, 3.618064415315282*^9, 3.6180652081013403`*^9, 
   3.6180653324916983`*^9, 3.618065394299646*^9, 3.618065468905487*^9, 
   3.6181373014716187`*^9, {3.618137372402103*^9, 3.6181374009795103`*^9}}]
}, Open  ]],

Cell["\<\
Income effect and borrowing rate\
\>", "Text",
 CellChangeTimes->{{3.618055000325111*^9, 3.618055007005275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "y"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "b"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"w2Liq", ",", "b"}], "]"}], ",", "y"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.618055147992218*^9, 3.618055175083374*^9}, {
  3.618055316880002*^9, 3.618055350484543*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "p2", " ", "\[Psi]1"}], "-", 
   RowBox[{"p1", " ", "\[Psi]2"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox["y", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.618055157025855*^9, 3.618055175789825*^9}, 
   3.618055318862088*^9, 3.618055351101281*^9, 3.6181374513522873`*^9, 
   3.6181377150161247`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p2", "+", "y"}], ")"}], " ", "\[Psi]1"}], 
   RowBox[{"2", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.618055157025855*^9, 3.618055175789825*^9}, 
   3.618055318862088*^9, 3.618055351101281*^9, 3.6181374513522873`*^9, 
   3.618137715017766*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p2", " ", "\[Psi]1"}], 
  RowBox[{"2", " ", 
   SuperscriptBox["y", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.618055157025855*^9, 3.618055175789825*^9}, 
   3.618055318862088*^9, 3.618055351101281*^9, 3.6181374513522873`*^9, 
   3.618137715018968*^9}]
}, Open  ]],

Cell["Price effect", "Text",
 CellChangeTimes->{{3.618059167933708*^9, 3.618059169686597*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "p2"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "p1"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"w2Liq", ",", "p2"}], "]"}], ",", "y"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"w2Liq", ",", "p2"}], "]"}], ",", "\[Psi]2"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.618059293888907*^9, 3.618059310243639*^9}, {
  3.618137848750709*^9, 3.6181379184459867`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "b"}], ")"}], " ", "\[Psi]1"}], 
   RowBox[{"2", " ", "y", " ", 
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.618059303772448*^9, 3.618059315580101*^9}, 
   3.6181374539426603`*^9, 3.618137612038875*^9, 3.6181377163705797`*^9, 
   3.618137870002194*^9, 3.618137920001212*^9}],

Cell[BoxData[
 FractionBox["\[Psi]2", 
  RowBox[{
   RowBox[{"2", " ", "y", " ", "\[Psi]1"}], "+", 
   RowBox[{"2", " ", "y", " ", "\[Psi]2"}]}]]], "Output",
 CellChangeTimes->{{3.618059303772448*^9, 3.618059315580101*^9}, 
   3.6181374539426603`*^9, 3.618137612038875*^9, 3.6181377163705797`*^9, 
   3.618137870002194*^9, 3.618137920004116*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "\[Psi]1"}], 
  RowBox[{"2", " ", 
   SuperscriptBox["y", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.618059303772448*^9, 3.618059315580101*^9}, 
   3.6181374539426603`*^9, 3.618137612038875*^9, 3.6181377163705797`*^9, 
   3.618137870002194*^9, 3.618137920005739*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "\[Psi]1"}], 
  RowBox[{"2", " ", "y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.618059303772448*^9, 3.618059315580101*^9}, 
   3.6181374539426603`*^9, 3.618137612038875*^9, 3.6181377163705797`*^9, 
   3.618137870002194*^9, 3.6181379200069942`*^9}]
}, Open  ]],

Cell["Quality effect", "Text",
 CellChangeTimes->{{3.618059330616311*^9, 3.618059333270143*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "\[Psi]2"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{"w2Liq", ",", "\[Psi]1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6180593351073513`*^9, 3.618059351148686*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", "\[Psi]1"}], 
  
  RowBox[{"2", " ", "y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.6180593516125383`*^9, 3.6181374568047953`*^9, 
  3.618137718896173*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", "\[Psi]2"}], 
   RowBox[{"2", " ", "y", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Psi]1", "+", "\[Psi]2"}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.6180593516125383`*^9, 3.6181374568047953`*^9, 
  3.618137718898994*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extension", "Subsection",
 CellChangeTimes->{{3.618137462108247*^9, 3.618137463747644*^9}}],

Cell["\<\
Now we extend the model by letting the store quality as a function of product \
assortment and travel cost. \
\>", "Text",
 CellChangeTimes->{{3.618137467764999*^9, 3.618137510030367*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Psi]1s", "=", 
  RowBox[{"\[Theta]1", "-", 
   RowBox[{"t", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]1", " ", "d"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]1", "^", "2"}], "/", "2"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]2s", "=", 
  RowBox[{"\[Theta]2", "-", 
   RowBox[{"t", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Theta]2", " ", "d"}], "+", 
      RowBox[{
       RowBox[{"\[Theta]2", "^", "2"}], "/", "2"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Psi]List", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Psi]1", "\[Rule]", "\[Psi]1s"}], ",", 
    RowBox[{"\[Psi]2", "\[Rule]", "\[Psi]2s"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.618137553848011*^9, 3.618137634279491*^9}, {
  3.618137761146397*^9, 3.618137791342579*^9}}],

Cell[BoxData[
 RowBox[{"\[Theta]1", "-", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "\[Theta]1"}], "+", 
     FractionBox[
      SuperscriptBox["\[Theta]1", "2"], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.618137589388384*^9, 3.6181376350067596`*^9, 
  3.61813772123853*^9, 3.618137791832315*^9}],

Cell[BoxData[
 RowBox[{"\[Theta]2", "-", 
  RowBox[{"t", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "\[Theta]2"}], "+", 
     FractionBox[
      SuperscriptBox["\[Theta]2", "2"], "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.618137589388384*^9, 3.6181376350067596`*^9, 
  3.61813772123853*^9, 3.6181377918343773`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Psi]1", "\[Rule]", 
    RowBox[{"\[Theta]1", "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "\[Theta]1"}], "+", 
        FractionBox[
         SuperscriptBox["\[Theta]1", "2"], "2"]}], ")"}]}]}]}], ",", 
   RowBox[{"\[Psi]2", "\[Rule]", 
    RowBox[{"\[Theta]2", "-", 
     RowBox[{"t", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "\[Theta]2"}], "+", 
        FractionBox[
         SuperscriptBox["\[Theta]2", "2"], "2"]}], ")"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.618137589388384*^9, 3.6181376350067596`*^9, 
  3.61813772123853*^9, 3.618137791835802*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w2Liq", "/.", "\[Psi]List"}], ")"}], ",", "\[Theta]2"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w2Liq", "/.", "\[Psi]List"}], ")"}], ",", "\[Theta]2"}], 
     "]"}], ",", "t"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6181377561365023`*^9, 3.618137757838375*^9}, {
  3.6181377965172987`*^9, 3.6181378208946667`*^9}, {3.618137939292911*^9, 
  3.618137951182227*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", "\[Theta]1", 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"2", " ", "d", " ", "t"}], "+", 
     RowBox[{"t", " ", "\[Theta]1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"d", " ", "t"}], "+", 
     RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}], 
  RowBox[{"y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "t"}]}], ")"}], " ", "\[Theta]1"}], "+", 
      RowBox[{"t", " ", 
       SuperscriptBox["\[Theta]1", "2"]}], "+", 
      RowBox[{"\[Theta]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", "d", " ", "t"}], "+", 
         RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.618137821684412*^9, 3.61813795179784*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "b"}], ")"}], " ", "p2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", "b"}], ")"}], " ", "y"}]}], ")"}], " ", "\[Theta]1", 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"t", " ", 
      SuperscriptBox["\[Theta]1", "3"]}], "+", 
     RowBox[{"2", " ", "t", " ", 
      SuperscriptBox["\[Theta]2", "3"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[Theta]1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", "t"}], "-", 
        RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}], "-", 
     RowBox[{"3", " ", "\[Theta]1", " ", "\[Theta]2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"2", " ", "d", " ", "t"}], "+", 
        RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "t"}]}], ")"}], " ", "\[Theta]1"}], "+", 
      RowBox[{"t", " ", 
       SuperscriptBox["\[Theta]1", "2"]}], "+", 
      RowBox[{"\[Theta]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", "d", " ", "t"}], "+", 
         RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}]}], ")"}], 
    "3"]}]]], "Output",
 CellChangeTimes->{3.618137821684412*^9, 3.6181379518363*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w2Liq", "/.", "\[Psi]List"}], ")"}], ",", "p2"}], "]"}], ",", 
    "\[Theta]2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6181380178855257`*^9, 3.618138024915896*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "b"}], ")"}], " ", "\[Theta]1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"2", " ", "d", " ", "t"}], "+", 
     RowBox[{"t", " ", "\[Theta]1"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"d", " ", "t"}], "+", 
     RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}], 
  RowBox[{"y", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "t"}]}], ")"}], " ", "\[Theta]1"}], "+", 
      RowBox[{"t", " ", 
       SuperscriptBox["\[Theta]1", "2"]}], "+", 
      RowBox[{"\[Theta]2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"2", " ", "d", " ", "t"}], "+", 
         RowBox[{"t", " ", "\[Theta]2"}]}], ")"}]}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.6181380253340063`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 928},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 22, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 170, 2, 39, "Subsubsection"],
Cell[752, 26, 189, 5, 62, "Text"],
Cell[944, 33, 168, 3, 40, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1149, 41, 106, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[1280, 46, 1347, 36, 210, "Input"],
Cell[2630, 84, 673, 14, 70, "Output"],
Cell[3306, 100, 605, 12, 70, "Output"],
Cell[3914, 114, 685, 15, 70, "Output"],
Cell[4602, 131, 630, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5269, 149, 750, 21, 130, "Input"],
Cell[6022, 172, 588, 13, 70, "Output"],
Cell[6613, 187, 432, 7, 70, "Output"],
Cell[7048, 196, 506, 10, 70, "Output"]
}, Open  ]],
Cell[7569, 209, 944, 29, 205, "Text"],
Cell[CellGroupData[{
Cell[8538, 242, 1651, 46, 199, "Input"],
Cell[10192, 290, 466, 10, 70, "Output"],
Cell[10661, 302, 309, 4, 70, "Output"],
Cell[10973, 308, 309, 4, 70, "Output"],
Cell[11285, 314, 902, 26, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12224, 345, 1846, 52, 199, "Input"],
Cell[14073, 399, 1487, 40, 70, "Output"],
Cell[15563, 441, 826, 18, 70, "Output"],
Cell[16392, 461, 884, 20, 70, "Output"],
Cell[17279, 483, 1149, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18465, 519, 2754, 75, 199, "Input"],
Cell[21222, 596, 761, 19, 70, "Output"],
Cell[21986, 617, 455, 8, 70, "Output"],
Cell[22444, 627, 455, 8, 70, "Output"],
Cell[22902, 637, 2237, 73, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25176, 715, 1024, 31, 130, "Input"],
Cell[26203, 748, 399, 9, 70, "Output"],
Cell[26605, 759, 505, 13, 70, "Output"],
Cell[27113, 774, 1008, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28158, 810, 1262, 38, 130, "Input"],
Cell[29423, 850, 717, 19, 70, "Output"],
Cell[30143, 871, 2565, 74, 70, "Output"],
Cell[32711, 947, 1454, 42, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[34214, 995, 110, 1, 25, "Subsubsection"],
Cell[CellGroupData[{
Cell[34349, 1000, 16083, 383, 957, "Input"],
Cell[50435, 1385, 8288, 157, 903, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58772, 1548, 113, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[58910, 1553, 217, 3, 87, "Input"],
Cell[59130, 1558, 939, 29, 67, "Output"],
Cell[60072, 1589, 845, 26, 81, "Output"],
Cell[60920, 1617, 2054, 70, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63011, 1692, 172, 2, 87, "Input"],
Cell[63186, 1696, 139, 2, 40, "Output"],
Cell[63328, 1700, 159, 3, 63, "Output"],
Cell[63490, 1705, 557, 16, 67, "Output"]
}, Open  ]],
Cell[64062, 1724, 411, 7, 62, "Text"],
Cell[CellGroupData[{
Cell[64498, 1735, 6206, 162, 438, "Input"],
Cell[70707, 1899, 5091, 96, 874, "Output"]
}, Open  ]],
Cell[75813, 1998, 122, 3, 58, "Text"],
Cell[CellGroupData[{
Cell[75960, 2005, 526, 13, 130, "Input"],
Cell[76489, 2020, 479, 13, 103, "Output"],
Cell[76971, 2035, 409, 11, 100, "Output"],
Cell[77383, 2048, 361, 9, 103, "Output"]
}, Open  ]],
Cell[77759, 2060, 94, 1, 58, "Text"],
Cell[CellGroupData[{
Cell[77878, 2065, 718, 20, 165, "Input"],
Cell[78599, 2087, 432, 11, 100, "Output"],
Cell[79034, 2100, 345, 7, 100, "Output"],
Cell[79382, 2109, 433, 11, 103, "Output"],
Cell[79818, 2122, 437, 11, 103, "Output"]
}, Open  ]],
Cell[80270, 2136, 96, 1, 58, "Text"],
Cell[CellGroupData[{
Cell[80391, 2141, 317, 7, 96, "Input"],
Cell[80711, 2150, 517, 17, 103, "Output"],
Cell[81231, 2169, 545, 17, 103, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81825, 2192, 97, 1, 76, "Subsection"],
Cell[81925, 2195, 198, 4, 58, "Text"],
Cell[CellGroupData[{
Cell[82148, 2203, 834, 25, 130, "Input"],
Cell[82985, 2230, 336, 9, 111, "Output"],
Cell[83324, 2241, 338, 9, 111, "Output"],
Cell[83665, 2252, 694, 21, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84396, 2278, 614, 17, 96, "Input"],
Cell[85013, 2297, 1219, 40, 112, "Output"],
Cell[86235, 2339, 1575, 49, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87847, 2393, 320, 9, 60, "Input"],
Cell[88170, 2404, 1022, 33, 112, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
